---
// Interactive architecture diagram: Expo App -> Convex Backend -> Cloudflare Edge + Maileroo
// Inline SVG with CSS hover transitions, viewBox-based responsive scaling
---

<div class="architecture-diagram w-full overflow-x-auto">
  <svg
    role="img"
    aria-label="Architecture diagram showing cross-platform application with Expo clients, Convex real-time backend, Cloudflare edge proxy, and Maileroo email service"
    viewBox="0 0 820 520"
    xmlns="http://www.w3.org/2000/svg"
    class="w-full h-auto"
    style="min-width: 320px; max-width: 820px; margin: 0 auto; display: block;"
  >
    <title>Architecture diagram showing cross-platform application with Expo clients, Convex real-time backend, Cloudflare edge proxy, and Maileroo email service</title>
    <defs>
      <marker id="cp-arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
        <polygon points="0 0, 10 3.5, 0 7" fill="#6B6560" />
      </marker>
      <marker id="cp-arrowhead-both" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto-start-reverse">
        <polygon points="0 0, 10 3.5, 0 7" fill="#6B6560" />
      </marker>
    </defs>

    <!-- Expo Clients column -->
    <g class="diagram-box diagram-box--clients">
      <rect x="20" y="30" width="190" height="200" rx="8" ry="8" fill="#2D3748" stroke="#2D3748" stroke-width="1.5" />
      <text x="115" y="58" text-anchor="middle" fill="#FFFFFF" font-family="'DM Sans', system-ui, sans-serif" font-size="14" font-weight="700">Expo Clients</text>
      <line x1="50" y1="68" x2="180" y2="68" stroke="#FFFFFF" stroke-opacity="0.2" stroke-width="0.75" />
      <!-- iOS -->
      <rect x="40" y="82" width="150" height="32" rx="5" ry="5" fill="#FFFFFF" fill-opacity="0.1" />
      <text x="115" y="103" text-anchor="middle" fill="#FFFFFF" font-family="'DM Sans', system-ui, sans-serif" font-size="11" fill-opacity="0.9">iOS (React Native)</text>
      <!-- Android -->
      <rect x="40" y="122" width="150" height="32" rx="5" ry="5" fill="#FFFFFF" fill-opacity="0.1" />
      <text x="115" y="143" text-anchor="middle" fill="#FFFFFF" font-family="'DM Sans', system-ui, sans-serif" font-size="11" fill-opacity="0.9">Android (React Native)</text>
      <!-- Web -->
      <rect x="40" y="162" width="150" height="32" rx="5" ry="5" fill="#FFFFFF" fill-opacity="0.1" />
      <text x="115" y="183" text-anchor="middle" fill="#FFFFFF" font-family="'DM Sans', system-ui, sans-serif" font-size="11" fill-opacity="0.9">Web (Expo Export)</text>
      <text x="115" y="218" text-anchor="middle" fill="#FFFFFF" font-family="'DM Sans', system-ui, sans-serif" font-size="9" fill-opacity="0.5">Single TypeScript Codebase</text>
    </g>

    <!-- Arrow: Clients -> Convex -->
    <line x1="210" y1="130" x2="290" y2="130" stroke="#6B6560" stroke-width="1.5" marker-end="url(#cp-arrowhead)" marker-start="url(#cp-arrowhead-both)" />
    <text x="250" y="118" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="9" font-weight="500">Real-Time</text>
    <text x="250" y="150" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="9" font-weight="500">Subscriptions</text>

    <!-- Convex Backend (centre) -->
    <g class="diagram-box diagram-box--convex">
      <rect x="295" y="30" width="230" height="280" rx="8" ry="8" fill="#FFFFFF" stroke="#C2714F" stroke-width="2" />
      <text x="410" y="58" text-anchor="middle" fill="#C2714F" font-family="'DM Sans', system-ui, sans-serif" font-size="14" font-weight="700">Convex Backend</text>
      <text x="410" y="75" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Reactive Database + Functions</text>
      <line x1="320" y1="85" x2="500" y2="85" stroke="#E5E0DA" stroke-width="0.75" />
      <!-- Feature list -->
      <circle cx="325" cy="105" r="2.5" fill="#C2714F" />
      <text x="335" y="109" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Real-Time Database (24 tables)</text>
      <circle cx="325" cy="128" r="2.5" fill="#C2714F" />
      <text x="335" y="132" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Better Auth (Google, Apple, Email)</text>
      <circle cx="325" cy="151" r="2.5" fill="#C2714F" />
      <text x="335" y="155" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Generated TypeScript SDK</text>
      <circle cx="325" cy="174" r="2.5" fill="#C2714F" />
      <text x="335" y="178" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Queries, Mutations, Actions</text>
      <circle cx="325" cy="197" r="2.5" fill="#C2714F" />
      <text x="335" y="201" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Full-Text Search Indexes</text>
      <circle cx="325" cy="220" r="2.5" fill="#C2714F" />
      <text x="335" y="224" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Scheduled Cron Jobs</text>
      <circle cx="325" cy="243" r="2.5" fill="#C2714F" />
      <text x="335" y="247" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Email Queue + Rate Limiting</text>
      <circle cx="325" cy="266" r="2.5" fill="#C2714F" />
      <text x="335" y="270" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Regional Data Partitioning</text>
      <circle cx="325" cy="289" r="2.5" fill="#C2714F" />
      <text x="335" y="293" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Database Migrations</text>
    </g>

    <!-- Arrow: Convex -> Cloudflare -->
    <line x1="525" y1="100" x2="605" y2="100" stroke="#6B6560" stroke-width="1.5" marker-end="url(#cp-arrowhead)" marker-start="url(#cp-arrowhead-both)" />
    <text x="565" y="88" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="9" font-weight="500">OAuth Proxy</text>
    <text x="565" y="120" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="9" font-weight="500">Header Rewrite</text>

    <!-- Cloudflare Edge box -->
    <g class="diagram-box diagram-box--cloudflare">
      <rect x="610" y="50" width="190" height="120" rx="8" ry="8" fill="#2D3748" stroke="#2D3748" stroke-width="1.5" />
      <text x="705" y="80" text-anchor="middle" fill="#FFFFFF" font-family="'DM Sans', system-ui, sans-serif" font-size="13" font-weight="600">Cloudflare Edge</text>
      <line x1="640" y1="90" x2="770" y2="90" stroke="#FFFFFF" stroke-opacity="0.2" stroke-width="0.75" />
      <text x="705" y="110" text-anchor="middle" fill="#FFFFFF" font-family="'DM Sans', system-ui, sans-serif" font-size="10" fill-opacity="0.7">Pages (Static Hosting)</text>
      <text x="705" y="128" text-anchor="middle" fill="#FFFFFF" font-family="'DM Sans', system-ui, sans-serif" font-size="10" fill-opacity="0.7">Functions (Auth Proxy)</text>
      <text x="705" y="146" text-anchor="middle" fill="#FFFFFF" font-family="'DM Sans', system-ui, sans-serif" font-size="10" fill-opacity="0.7">SSL / DDoS / DNS</text>
    </g>

    <!-- Arrow: Convex -> Maileroo -->
    <line x1="525" y1="230" x2="605" y2="230" stroke="#6B6560" stroke-width="1.5" marker-end="url(#cp-arrowhead)" />
    <text x="565" y="218" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="9" font-weight="500">SMTP API</text>
    <text x="565" y="250" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="9" font-weight="500">Transactional</text>

    <!-- Maileroo box -->
    <g class="diagram-box diagram-box--maileroo">
      <rect x="610" y="200" width="190" height="70" rx="8" ry="8" fill="#FFFFFF" stroke="#E5E0DA" stroke-width="1.5" />
      <text x="705" y="228" text-anchor="middle" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="13" font-weight="600">Maileroo</text>
      <text x="705" y="248" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Transactional Email</text>
    </g>

    <!-- Arrow: Convex -> Data Patterns (vertical) -->
    <line x1="410" y1="310" x2="410" y2="370" stroke="#6B6560" stroke-width="1.5" marker-end="url(#cp-arrowhead)" />

    <!-- Data Patterns box -->
    <g class="diagram-box diagram-box--patterns">
      <rect x="210" y="375" width="400" height="120" rx="8" ry="8" fill="#FFFFFF" stroke="#E5E0DA" stroke-width="1.5" />
      <text x="410" y="400" text-anchor="middle" fill="#2D2A26" font-family="'DM Sans', system-ui, sans-serif" font-size="13" font-weight="600">Architecture Patterns</text>
      <line x1="240" y1="410" x2="580" y2="410" stroke="#E5E0DA" stroke-width="0.75" />
      <!-- Two columns -->
      <text x="310" y="432" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Code Health Lifecycle</text>
      <text x="310" y="450" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Denormalized Leaderboards</text>
      <text x="310" y="468" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Soft Deletes / Audit Trail</text>
      <text x="310" y="486" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Regional Data Partitioning</text>
      <text x="510" y="432" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Social Graph Discovery</text>
      <text x="510" y="450" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Priority Email Queue</text>
      <text x="510" y="468" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Batch Fetch Optimization</text>
      <text x="510" y="486" text-anchor="middle" fill="#6B6560" font-family="'DM Sans', system-ui, sans-serif" font-size="10">Content-Scoped Search</text>
    </g>
  </svg>
</div>

<style>
  .diagram-box {
    transition: filter 0.25s ease, transform 0.25s ease;
    transform-origin: center;
  }

  .diagram-box:hover {
    filter: drop-shadow(0 4px 12px rgba(194, 113, 79, 0.25));
    transform: scale(1.02);
  }

  @media (prefers-reduced-motion: reduce) {
    .diagram-box {
      transition: none;
    }
    .diagram-box:hover {
      transform: none;
    }
  }
</style>
